

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Dataset Guide (Incl. Integration to new API Delira v0.3.2) &mdash; delira 0.3.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Classification with Delira - A very short introduction" href="classification_pytorch.html" />
    <link rel="prev" title="Delira Introduction" href="tutorial_delira.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/delira.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.3.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#backends">Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#installation">Installation</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial_delira.html">Delira Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial_delira.html#loading-data">Loading Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#the-dataset">The Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#the-dataloader">The Dataloader</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#the-datamanager">The Datamanager</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#sampler">Sampler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_delira.html#models">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#init"><code class="docutils literal notranslate"><span class="pre">__init__</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#closure"><code class="docutils literal notranslate"><span class="pre">closure</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#prepare-batch"><code class="docutils literal notranslate"><span class="pre">prepare_batch</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_delira.html#abstract-networks-for-specific-backends">Abstract Networks for specific Backends</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#pytorch">PyTorch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial_delira.html#forward"><code class="docutils literal notranslate"><span class="pre">forward</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial_delira.html#id1"><code class="docutils literal notranslate"><span class="pre">prepare_batch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial_delira.html#closure-example"><code class="docutils literal notranslate"><span class="pre">closure</span> <span class="pre">example</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#other-examples">Other examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_delira.html#training">Training</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#trainer">Trainer</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#experiment">Experiment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_delira.html#logging">Logging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#multistreamhandler"><code class="docutils literal notranslate"><span class="pre">MultiStreamHandler</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_delira.html#logging-with-visdom-the-trixi-loggers">Logging with <code class="docutils literal notranslate"><span class="pre">Visdom</span></code> - The <code class="docutils literal notranslate"><span class="pre">trixi</span></code> Loggers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial_delira.html#types-of-visdomhandlers">Types of VisdomHandlers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_delira.html#more-examples">More Examples</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dataset Guide (Incl. Integration to new API Delira v0.3.2)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview-old-api">Overview Old API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overview-new-api">Overview New API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#new-datasets">New Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#new-utility-function-integration-to-new-api">New Utility Function (Integration to new API)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="classification_pytorch.html">Classification with Delira - A very short introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="classification_pytorch.html#logging-and-visualization">Logging and Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="classification_pytorch.html#data-preparation">Data Preparation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="classification_pytorch.html#loading">Loading</a></li>
<li class="toctree-l3"><a class="reference internal" href="classification_pytorch.html#augmentation">Augmentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="classification_pytorch.html#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="classification_pytorch.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gan_pytorch.html">Generative Adversarial Nets with Delira - A very short introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gan_pytorch.html#hyperparameters">HyperParameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="gan_pytorch.html#logging-and-visualization">Logging and Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="gan_pytorch.html#data-preparation">Data Preparation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gan_pytorch.html#loading">Loading</a></li>
<li class="toctree-l3"><a class="reference internal" href="gan_pytorch.html#augmentation">Augmentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gan_pytorch.html#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="gan_pytorch.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="segmentation_2d_pytorch.html">Segmentation in 2D using U-Nets with Delira - A very short introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="segmentation_2d_pytorch.html#logging-and-visualization">Logging and Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="segmentation_2d_pytorch.html#data-praparation">Data Praparation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="segmentation_2d_pytorch.html#loading">Loading</a></li>
<li class="toctree-l3"><a class="reference internal" href="segmentation_2d_pytorch.html#augmentation">Augmentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="segmentation_2d_pytorch.html#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="segmentation_2d_pytorch.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="segmentation_3d_pytorch.html">Segmentation in 3D using U-Nets with Delira - A very short introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="segmentation_3d_pytorch.html#logging-and-visualization">Logging and Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="segmentation_3d_pytorch.html#data-praparation">Data Praparation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="segmentation_3d_pytorch.html#loading">Loading</a></li>
<li class="toctree-l3"><a class="reference internal" href="segmentation_3d_pytorch.html#augmentation">Augmentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="segmentation_3d_pytorch.html#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="segmentation_3d_pytorch.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_api/_build/modules.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="_api/_build/delira/delira.html">Delira</a><ul>
<li class="toctree-l3"><a class="reference internal" href="_api/_build/delira/data_loading/data_loading.html">Data Loading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/data_loading/arbitrary_data.html">Arbitrary Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/data_loading/nii.html">Nii</a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/data_loading/sampler.html">Sampler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="_api/_build/delira/delira.io.html">IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="_api/_build/delira/logging/logging.html">Logging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/logging/handlers.html"><span class="hidden-section">MultiStreamHandler</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/logging/handlers.html#trixihandler"><span class="hidden-section">TrixiHandler</span></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="_api/_build/delira/models/models.html">Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/models/classification.html">Classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/models/gan.html">Generative Adversarial Networks</a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/models/segmentation.html">Segmentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="_api/_build/delira/training/training.html">Training</a><ul>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/parameters.html">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/trainer.html">Network Trainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/experiment.html">Experiment</a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/callbacks.html">Callbacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/losses.html">Losses</a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/utils.html"><span class="hidden-section">AurocMetricPyTorch</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/utils.html#accurarcymetricpytorch"><span class="hidden-section">AccurarcyMetricPyTorch</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/utils.html#pytorch-batch-to-numpy"><span class="hidden-section">pytorch_batch_to_numpy</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/utils.html#pytorch-tensor-to-numpy"><span class="hidden-section">pytorch_tensor_to_numpy</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/utils.html#float-to-pytorch-tensor"><span class="hidden-section">float_to_pytorch_tensor</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/utils.html#create-optims-default-pytorch"><span class="hidden-section">create_optims_default_pytorch</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/utils.html#create-optims-gan-default-pytorch"><span class="hidden-section">create_optims_gan_default_pytorch</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="_api/_build/delira/training/utils.html#create-optims-default-tf"><span class="hidden-section">create_optims_default_tf</span></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="_api/_build/delira/delira.utils.html">Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="_api/_build/delira/class_hierarchy.html">Class Hierarchy Diagrams</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/justusschock/delira">GitHub</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">delira</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Dataset Guide (Incl. Integration to new API Delira v0.3.2)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tutorial_dataset.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dataset-guide-incl-integration-to-new-api-delira-v0-3-2">
<h1>Dataset Guide (Incl. Integration to new API Delira v0.3.2)<a class="headerlink" href="#dataset-guide-incl-integration-to-new-api-delira-v0-3-2" title="Permalink to this headline">¶</a></h1>
<p><em>Author: Michael Baumgartner</em></p>
<p><em>Date: 13.05.2019</em></p>
<p>With Delira v0.3.2 a new dataset API was introduced to allow for more
flexibility and add some features. This notebook shows the difference between
the new and the old API and provides some examples for newly added features.</p>
<div class="section" id="overview-old-api">
<h2>Overview Old API<a class="headerlink" href="#overview-old-api" title="Permalink to this headline">¶</a></h2>
<p>The old dataset API was based on the assumption that
the underlying structure of the data can be described as followed:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>root</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>sample1</dt>
<dd><ul class="first last">
<li>img1</li>
<li>img2</li>
<li>label</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>sample2</dt>
<dd><ul class="first last">
<li>img1</li>
<li>img2</li>
<li>label</li>
</ul>
</dd>
</dl>
</li>
<li>…</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>A single sample was constructed from multiple images which are all
located in the same subdirectory. The corresponding signature of the
<code class="docutils literal notranslate"><span class="pre">AbstractDataset</span></code> was given by
<code class="docutils literal notranslate"><span class="pre">data_path,</span> <span class="pre">load_fn,</span> <span class="pre">img_extensions,</span> <span class="pre">gt_extensions</span></code>. While most
datasets need a <code class="docutils literal notranslate"><span class="pre">load_fn</span></code> to load a single sample and a <code class="docutils literal notranslate"><span class="pre">data_path</span></code>
to the root directory, <code class="docutils literal notranslate"><span class="pre">img_extensions</span></code>and <code class="docutils literal notranslate"><span class="pre">gt_exntensions</span></code> were
often unsed. As a consequence a new dataset needed to be created which
initialises the unused variables with arbitrary values.</p>
</div>
<div class="section" id="overview-new-api">
<h2>Overview New API<a class="headerlink" href="#overview-new-api" title="Permalink to this headline">¶</a></h2>
<p>The new dataset API was refactored to a more general
approach where only a <code class="docutils literal notranslate"><span class="pre">data_path</span></code> to the root directory and a
<code class="docutils literal notranslate"><span class="pre">load_fn</span></code> for a single sample need to be provided. A simple loading
function (<code class="docutils literal notranslate"><span class="pre">load_fn</span></code>) to generate random data independent from the
given path might be realized as below.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">load_random_data</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load random data</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        path to sample (not used in this example)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        return data inside a dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span>
        <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>When used with the provided BaseDatasets, the return value of the load
function is not limited to dictionaries and might be of any type which
can be added to a list with the <code class="docutils literal notranslate"><span class="pre">append</span></code> method.</p>
<div class="section" id="new-datasets">
<h3>New Datasets<a class="headerlink" href="#new-datasets" title="Permalink to this headline">¶</a></h3>
<p>Some basic datasets are already implemented inside
Delira and should be suitable for most cases. The <code class="docutils literal notranslate"><span class="pre">BaseCacheDataset</span></code>
saves all samples inside the RAM and thus can only be used if everything
fits inside the memory. ´BaseLazyDataset´ loads the individual samples
on time when they are needed, but might lead to slower training due to
the additional loading time.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">delira.data_loading</span> <span class="k">import</span> <span class="n">BaseCacheDataset</span><span class="p">,</span> <span class="n">BaseLazyDataset</span>


<span class="c1"># because `load_random_data` does not use the path argument, they can have</span>
<span class="c1"># arbitrary values in this example</span>
<span class="n">paths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="c1"># create case dataset</span>
<span class="n">cached_set</span> <span class="o">=</span> <span class="n">BaseCacheDataset</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">load_random_data</span><span class="p">)</span>

<span class="c1"># create lazy dataset</span>
<span class="n">lazy_set</span> <span class="o">=</span> <span class="n">BaseLazyDataset</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">load_random_data</span><span class="p">)</span>

<span class="c1"># print cached data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cached_set</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="c1"># print lazy data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lazy_set</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
<p>In the above example a list of multiple paths is used as the
<code class="docutils literal notranslate"><span class="pre">data_path</span></code>. <code class="docutils literal notranslate"><span class="pre">load_fn</span></code> is called for every element inside the
provided list (can be any iterator). If <code class="docutils literal notranslate"><span class="pre">data_path</span></code> is a single
string, it is assumed to be the path to the root directory. In this
case, <code class="docutils literal notranslate"><span class="pre">load_fn</span></code>is called for every element inside the root
directory.</p>
<p>Sometimes, a single file/folder contains multiple samples.
<code class="docutils literal notranslate"><span class="pre">BaseExtendCacheDataset</span></code> uses the <code class="docutils literal notranslate"><span class="pre">extend</span></code> function to add elements
to the internal list. Thus it is assumed that <code class="docutils literal notranslate"><span class="pre">load_fn</span></code> provides an
iterable object, where eacht item represents a single data sample.</p>
<p><code class="docutils literal notranslate"><span class="pre">AbstractDataset</span></code> is now iterable and can be used directly in
combination with for loops.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">cs</span> <span class="ow">in</span> <span class="n">cached_set</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="new-utility-function-integration-to-new-api">
<h3>New Utility Function (Integration to new API)<a class="headerlink" href="#new-utility-function-integration-to-new-api" title="Permalink to this headline">¶</a></h3>
<p>The behavior of the old
API can be replicated with the <code class="docutils literal notranslate"><span class="pre">LoadSample</span></code>,
<code class="docutils literal notranslate"><span class="pre">LoadSampleLabel</span></code>functions. <code class="docutils literal notranslate"><span class="pre">LoadSample</span></code> assumes that all needed
images and the label (for a single sample) are located in a directory.
Both functions return a dictionary containing the loaded data.
<code class="docutils literal notranslate"><span class="pre">sample_ext</span></code> maps keys to iterables. Each iterable defines the names
of the images which should be loaded from the directory. ´sample_fn´ is
used to load the images which are than stacked inside a single array.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">delira.data_loading</span> <span class="k">import</span> <span class="n">LoadSample</span><span class="p">,</span> <span class="n">LoadSampleLabel</span>


<span class="k">def</span> <span class="nf">load_random_array</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return random data</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        path to image</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        loaded data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>


<span class="c1"># define the function to load a single sample from a directory</span>
<span class="n">load_fn</span> <span class="o">=</span> <span class="n">LoadSample</span><span class="p">(</span>
    <span class="n">sample_ext</span><span class="o">=</span><span class="p">{</span>
        <span class="c1"># load 3 data channels</span>
        <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red.png&#39;</span><span class="p">,</span> <span class="s1">&#39;green.png&#39;</span><span class="p">,</span> <span class="s1">&#39;blue.png&#39;</span><span class="p">],</span>
        <span class="c1"># load a singel segmentation channel</span>
        <span class="s1">&#39;seg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;seg.png&#39;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="n">sample_fn</span><span class="o">=</span><span class="n">load_random_array</span><span class="p">,</span>
    <span class="c1"># optionally: assign individual keys a datatype</span>
    <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;seg&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">},</span>
    <span class="c1"># optioanlly: normalize individual samples</span>
    <span class="n">normalize</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>

<span class="c1"># Note: in general the function should be called with the path of the</span>
<span class="c1"># directory where the imags are located</span>
<span class="n">sample0</span> <span class="o">=</span> <span class="n">load_fn</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;data shape: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sample0</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;segmentation shape: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sample0</span><span class="p">[</span><span class="s2">&quot;seg&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;data type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sample0</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;segmentation type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sample0</span><span class="p">[</span><span class="s2">&quot;seg&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;data min value: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sample0</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;data max value: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sample0</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</pre></div>
</div>
<p>By default the range is normalized to (-1, 1), but <code class="docutils literal notranslate"><span class="pre">norm_fn</span></code> can be
changed to achieve other normalization schemes. Some examples are
included in <code class="docutils literal notranslate"><span class="pre">delira.data_loading.load_utils</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">LoadSampleLabel</span></code> takes an additional argument for the label and a
function to load a label. This functions can be used in combination with
the provided BaseDatasets to replicate (and extend) the old API.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="classification_pytorch.html" class="btn btn-neutral float-right" title="Classification with Delira - A very short introduction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorial_delira.html" class="btn btn-neutral float-left" title="Delira Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Justus Schock, Oliver Rippel, Christoph Haarburger

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>